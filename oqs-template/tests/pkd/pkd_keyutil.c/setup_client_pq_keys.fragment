{%- for sig in config['sigs'] %}
    {%- for variant in sig['variants'] %}
        if (access(OPENSSH_{{ variant['name']|upper }}_TESTKEY, F_OK) != 0) {
            rc = system_checked(OPENSSH_KEYGEN " -t {{ variant['name']|upper|replace('_','') }} -q -N \"\" -f "
                                OPENSSH_{{ variant['name']|upper }}_TESTKEY);
        }
        assert_int_equal(rc, 0);
        {%- for classical_alg in variant['mix_with'] %}
        if (access(OPENSSH_{{ classical_alg['name']|upper }}_{{ variant['name']|upper }}_TESTKEY, F_OK) != 0) {
            rc = system_checked(OPENSSH_KEYGEN " -t {{ classical_alg['name']|upper }}_{{ variant['name']|upper|replace('_','') }} -q -N \"\" -f "
                                OPENSSH_{{ classical_alg['name']|upper }}_{{ variant['name']|upper }}_TESTKEY);
        }
        assert_int_equal(rc, 0);
        {%- endfor %}
    {%- endfor %}
{%- endfor %}

